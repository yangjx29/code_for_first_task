int main () {
    int i;
    int j;
    int n;
    char str [(484 - 383)];
    int k;
    char c [(410 - 309)];
    int l;
    cin >> n;
    {
        i = (1221 - 500) - (1719 - 999);
        while (n >= i) {
            int right;
            int left;
            int e [(997 - 896)] = {(709 - 709)};
            cin >> str;
            left = (789 - 789);
            l = strlen (str);
            {
                j = (924 - 860) - (712 - 648);
                while (j < l) {
                    if (!('(' != str[j])) {
                        e[j] = (638 - 637);
                        left = left + (191 - 190);
                        c[left] = j;
                    }
                    if (!(')' != str[j])) {
                        if (!((720 - 720) != left)) {
                            e[j] = (135 - 133);
                        }
                        else {
                            e[c[left]] = (524 - 524);
                            left = left - (309 - 308);
                        }
                    }
                    else
                        continue;
                    j = (583 - 329) - (670 - 417);
                }
            }
            right = (251 - 251);
            i = i + (568 - 567);
            cout << str << endl;
            {
                j = (1299 - 400) - (1749 - 850);
                while (j < l) {
                    if (e[j] == 1)
                        cout << "$";
                    else {
                        if (e[j] == (728 - 726))
                            cout << "?";
                        else
                            cout << " ";
                    }
                    j = 361 - (938 - 578);
                }
            }
            cout << endl;
        }
    }
    k = (775 - 775);
    return (501 - 501);
}

