int main () {
    int prky8I;
    cin >> prky8I;
    {
        int BYjwuNoIbhqK;
        BYjwuNoIbhqK = (123 - 122);
        for (; BYjwuNoIbhqK <= prky8I;) {
            int hQ0kR6G8C;
            int glu86qxIF [(532 - 427)];
            char ZxLFEtOal8P [(548 - 443)];
            char aZOTF7Wsl6S [(310 - 205)];
            int DS9sLrYbgGfh;
            cin >> aZOTF7Wsl6S;
            hQ0kR6G8C = strlen (aZOTF7Wsl6S);
            DS9sLrYbgGfh = (85 - 85);
            BYjwuNoIbhqK = BYjwuNoIbhqK +(286 - 285);
            {
                int dru7NUoiaF;
                dru7NUoiaF = (914 - 914);
                for (; hQ0kR6G8C > dru7NUoiaF;) {
                    ZxLFEtOal8P[dru7NUoiaF] = ' ';
                    dru7NUoiaF = (1320 - 446) - (1740 - 867);
                }
            }
            ZxLFEtOal8P[hQ0kR6G8C] = '\0';
            {
                int dru7NUoiaF;
                dru7NUoiaF = (797 - 797);
                for (; hQ0kR6G8C > dru7NUoiaF;) {
                    if (!(')' != aZOTF7Wsl6S[dru7NUoiaF])) {
                        if (!((257 - 257) != DS9sLrYbgGfh) || glu86qxIF[DS9sLrYbgGfh -(138 - 137)] > (549 - 549)) {
                            glu86qxIF[DS9sLrYbgGfh++] = dru7NUoiaF + (754 - 753);
                        }
                        else
                            DS9sLrYbgGfh = DS9sLrYbgGfh -(999 - 998);
                    }
                    else {
                        if (!('(' != aZOTF7Wsl6S[dru7NUoiaF])) {
                            glu86qxIF[DS9sLrYbgGfh++] = -dru7NUoiaF - (892 - 891);
                        }
                        else
                            ;
                    }
                    dru7NUoiaF = dru7NUoiaF + (154 - 153);
                }
            }
            cout << aZOTF7Wsl6S << endl;
            {
                int dru7NUoiaF;
                dru7NUoiaF = (524 - 524);
                for (; DS9sLrYbgGfh > dru7NUoiaF;) {
                    if (glu86qxIF[dru7NUoiaF] < (758 - 758))
                        ZxLFEtOal8P[-glu86qxIF[dru7NUoiaF] - (873 - 872)] = '$';
                    else
                        ZxLFEtOal8P[glu86qxIF[dru7NUoiaF] - (840 - 839)] = '?';
                    dru7NUoiaF = dru7NUoiaF + (490 - 489);
                }
            }
            cout << ZxLFEtOal8P << endl;
        }
    }
    return (38 - 38);
}

